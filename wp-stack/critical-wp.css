/**
 * Critical CSS - Optimized for Lighthouse 100 (v51.0)
 */

/* SYSTEM FONT STACK */
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    padding: 0;
    -webkit-font-smoothing: antialiased;
}

/* ФИКС CLS: Логотип и Шапка */
.header-custom-logo {
    width: 64px !important;
    height: 64px !important;
    aspect-ratio: 1 / 1 !important;
    display: block !important;
    border-radius: 12px;
}

.header-site-title {
    font-size: 1.4rem !important;
    font-weight: 800;
    letter-spacing: -0.02em;
    color: var(--slate-900);
    /* replaced var(--slate-900) */
    margin-left: 15px;
    /* Gap logic from .header-logo-link */
}

.site-header {
    height: 120px !important;
    /* STRICT LOCK: Changed from min-height */
    /* SYNC WITH ASYNC CSS v72 */
    display: flex !important;
    align-items: flex-start !important;
    padding-top: 40px !important;
    background: transparent !important;
    overflow: hidden !important;
    /* CONTAINMENT */
}

.header-main-wrapper {
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    width: 100% !important;
    width: 100% !important;
    height: 100% !important;
}

/* ФИКС CLS: Flex layout для логотипа и текста */
.header-branding,
.header-logo-link {
    display: flex !important;
    align-items: center !important;
    flex-wrap: nowrap !important;
}

/* ФИКС МЕНЮ (v60.3 NUCLEAR) */
.header-navigation,
.header-navigation div,
.header-navigation ul {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: nowrap !important;
    align-items: center !important;
    justify-content: center !important;
    list-style: none !important;
    list-style-type: none !important;
    margin: 0 !important;
    padding: 0 !important;
    gap: 32px !important;
}

.header-navigation li {
    display: block !important;
    list-style: none !important;
    list-style-type: none !important;
    margin: 0 !important;
    padding: 0 !important;
}

.header-navigation a {
    text-decoration: none !important;
    color: var(--slate-900) !important;
    font-weight: 700 !important;
    font-size: 15px !important;
    white-space: nowrap !important;
}

@media (max-width: 1024px) {
    .header-custom-logo {
        width: 36px !important;
        height: 36px !important;
    }

    .site-header {
        height: 80px !important;
        /* STRICT LOCK: Changed from min-height */
        /* SYNC with commands-wp.css v12 Mobile/Tablet */
        padding: 15px 0 !important;
        /* SYNC with commands-wp.css v12 Mobile/Tablet */
        overflow: hidden !important;
        /* CONTAINMENT */
    }

    .header-site-title {
        font-size: 1.1rem !important;
        /* SYNC with commands-wp.css */
        font-family: sans-serif !important;
        /* FALLBACK STABILITY */
    }
}

/* ФИКС CLS: Контент (Заголовки и Мета) */
.post-meta {
    margin-bottom: 8px;
    font-size: 14px;
    color: #334155;
    /* Re-applied: Increased contrast from #64748b */
    min-height: 20px;
}

.post-hero {
    width: 100%;
    max-width: 1000px;
    margin: 0 auto 3.5rem;
    /* Critical for layout stability */
    border-radius: 32px;
    overflow: hidden;
    /* Box shadow omitted to save bytes, but margin/size is critical */
}

/* Default Grid Title (Archive/Cards) */
.post-title {
    font-size: 1.5rem !important;
    /* Reduced for Grid */
    line-height: 1.3 !important;
    font-weight: 700 !important;
    color: var(--slate-900) !important;
    margin-bottom: 0.5rem !important;
}

/* Single Hero Title (Large) */
.post-hero .post-title {
    font-size: 3.5rem !important;
    /* SYNC with Desktop Async */
    line-height: 1.1 !important;
    font-weight: 900 !important;
    margin-bottom: 1rem !important;
    /* v3.5 Design */
    color: var(--slate-900) !important;
    min-height: 140px !important;
    /* INCREASED: Space for 2-3 lines of text */
    display: block !important;
    contain: layout !important;
}

@media (max-width: 767px) {
    .post-title {
        font-size: 2.2rem !important;
        /* SYNC with comandos-wp.css */
        line-height: 1.3 !important;
        min-height: 120px !important;
        /* Adjusted for larger font */
    }
}

/* ФИКС CLS: Главное изображение */
.single-thumb,
.single-thumb img {
    /* BRUTE FORCE: 16/9 from User Setting (v100) */
    aspect-ratio: 16 / 9 !important;
    width: 100% !important;
    height: auto !important;
    object-fit: cover !important;
    display: block;
    background: var(--slate-100);
    border-radius: 20px;
}

@media (max-width: 767px) {
    .site-inner {
        padding: 0 16px !important;
    }
}

/* ФИКС CLS: Резервирование места под рекомендации v62.1 */
.related-posts {
    min-height: 400px;
    contain: content;
}

.related-grid {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    gap: 24px !important;
}

@media (max-width: 767px) {
    .related-grid {
        grid-template-columns: 1fr !important;
    }

    .related-posts {
        min-height: 800px;
    }
}

/* --- LAYOUT STABILIZATION v71.0 --- */
body {
    contain: layout;
}

.site-main {
    contain: layout;
    min-height: 100vh;
    padding-top: 2rem !important;
    /* SYNC WITH ASYNC */
}

/* Резервирование пространства для контента статьи */
.single-post {
    min-height: 2000px;
    max-width: 850px !important;
    /* DESKTOP STABILIZATION: Prevent width snapping */
    margin: 0 auto !important;
    width: 100% !important;
}

.post-content {
    min-height: 1200px;
}

.toc-box {
    min-height: 480px !important;
    contain: layout;
}

@media (max-width: 767px) {
    .single-post {
        min-height: 3000px;
    }

    .post-content {
        min-height: 1800px;
    }

    .toc-box {
        min-height: 900px !important;
        contain: layout;
    }
}

/* ФИКС CLS: Related Posts Containment (vNUCLEAR) */
.related-thumb-wrapper {
    width: 100% !important;
    aspect-ratio: 16 / 9 !important;
    overflow: hidden !important;
    background-color: var(--slate-100) !important;
    /* Skeleton placeholder */
    border-radius: 12px;
    display: block !important;
    margin-bottom: 12px;
}

.related-thumb {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
}